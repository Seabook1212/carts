server.port=${port:8081}
# spring.data.mongodb.uri=mongodb://${db:carts-db}:27017/data
spring.data.mongodb.uri=mongodb://carts-db.sock-shop.svc.cluster.local:27017/data?socketTimeoutMS=30000&connectTimeoutMS=10000&serverSelectionTimeoutMS=10000&maxPoolSize=50
spring.data.mongodb.connection-per-host=10

# Spring Boot 3: endpoints.health.enabled is now management.endpoint.health.enabled
management.endpoint.health.enabled=true

# Spring Boot 3: Tracing configuration (replaces Spring Cloud Sleuth)
management.tracing.sampling.probability=1.0
management.zipkin.tracing.endpoint=http://${zipkin_host:jaeger-collector.observability.svc.cluster.local}:9411/api/v2/spans
spring.application.name=carts
# Disable actuator metrics endpoints
# endpoints.metrics.enabled=false
# endpoints.prometheus.id=metrics

# management.endpoints.web.exposure.include=*
management.endpoints.web.exposure.include=health,prometheus,chaosmonkey
management.endpoint.prometheus.enabled=true
management.endpoint.chaosmonkey.enabled=true
management.metrics.export.prometheus.enabled=true

# Enable Chaos Monkey Spring profile
spring.profiles.active=${SPRING_PROFILES_ACTIVE:chaos-monkey}

# Logging pattern with explicit traceId and spanId labels
logging.pattern.level=%5p [${spring.application.name:},traceId:%X{traceId:-},spanId:%X{spanId:-}]
logging.pattern.console=%d{yyyy-MM-dd'T'HH:mm:ss.SSSXXX} %5p [${spring.application.name:},traceId:%X{traceId:-},spanId:%X{spanId:-}] --- [%15.15t] %-40.40logger{39} : %m%n

# logging.level.io.micrometer=DEBUG
# logging.level.org.springframework.boot.actuate=DEBUG
# --- Chaos Monkey 设置 ---
chaos.monkey.enabled=true

# Watcher：开启哪些切面（service, controller）
chaos.monkey.watcher.service=true
chaos.monkey.watcher.rest-controller=true

# Assaults：默认关闭，交给 Litmus 控制
chaos.monkey.assaults.latency-active=false
chaos.monkey.assaults.exceptions-active=false
chaos.monkey.assaults.kill-application-active=false
